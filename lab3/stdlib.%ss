(%define (%map fn list)
  (%if (%null? list)
       (%quote ())
       (%cons (fn (%car list))
                  (%map fn (%cdr list)))))